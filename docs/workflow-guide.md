# Novel-Writer-OpenSpec Workflow Guide

This guide details the complete process of using Novel-Writer-OpenSpec for novel creation.

## Table of Contents

1. [Preparation](#preparation)
2. [Five-Stage Workflow](#five-stage-workflow)
3. [Practical Example](#practical-example)
4. [FAQ](#faq)
5. [Best Practices](#best-practices)

---

## Preparation

### Install Tool

```bash
npm install -g novelspec
```

### Initialize Project

```bash
novelspec init my-novel
cd my-novel
```

### Configure Project

Edit `novelspec/project.md`:

1. **Project Info**: Novel name, genre, target word count, volume count
2. **Creative Principles**: Logical consistency, character consistency, plot reasonableness, unified style
3. **Style Guide**: Narrative perspective, language style, chapter length, update frequency
4. **Quality Standards**: Each chapter must advance the plot, dialogue fits the character, descriptions are visual
5. **Taboos**: No modern internet slang, no arbitrary setting changes, no OOC (Out of Character) behavior

---

## Five-Stage Workflow

Novel-Writer-OpenSpec adopts a five-stage cyclic workflow:

```
Create Proposal â†’ Validate Proposal â†’ Execute Writing â†’ Continuous Verification â†’ Archive Change
    â†‘                                           â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Start Next Batch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Stage 1: Create Change Proposal

**Goal**: Clarify the goal, scope, and specifications of this creation.

#### Create using AI Assistant

Execute in Cursor/Claude/Windsurf:

```
/novelspec-proposal
```

AI will ask:

```
Which chapter do you want to write? or what setting to extend?
```

#### Answer Examples

**Example 1: Write Chapters**

```
Write chapters 1-10, protagonist travels to a fantasy world, obtains a sign-in system, completes introductory cultivation
```

**Example 2: Extend Setting**

```
Extend magic system, add advanced cultivation levels and skills
```

**Example 3: Add Character**

```
Add supporting character: Genius disciple Li Jian, top genius of the outer sect, Qi Refining Level 8
```

#### Content Generated by AI

AI will create:

1. **Directory Structure**

```
novelspec/changes/add-chapter-1-10/
â”œâ”€â”€ proposal.md      # Change proposal
â”œâ”€â”€ tasks.md         # Task list
â””â”€â”€ specs/           # Spec deltas
    â”œâ”€â”€ outline/spec.md
    â”œâ”€â”€ characters/protagonist/spec.md
    â””â”€â”€ worldbuilding/magic-system/spec.md
```

2. **proposal.md** (Change Intent)

```markdown
## Why
Protagonist introduction arc, establishing worldview and basic settings.

## What Changes
- Add outline specs for chapters 1-10
- Define protagonist basic settings
- Define sign-in system rules

## Impact
- `specs/outline/spec.md` (Add 10 chapters)
- `specs/characters/protagonist/spec.md` (Added)
- `specs/worldbuilding/magic-system/spec.md` (Add sign-in system)
```

3. **tasks.md** (Task List)

```markdown
## 1. Spec Updates
- [ ] 1.1 Create protagonist spec
- [ ] 1.2 Create sign-in system spec
- [ ] 1.3 Create outline for chapters 1-10

## 2. Chapter Writing
- [ ] 2.1 Chapter 1: Awakening
- [ ] 2.2 Chapter 2: Exploring the System
- [ ] 2.3 Chapter 3: First Try
...
```

4. **specs/ Deltas** (Spec Changes)

```markdown
# novelspec/changes/add-chapter-1-10/specs/outline/spec.md

## ADDED Requirements

### Requirement: Chapter 1 - Awakening
Chapter 1 SHALL establish the worldview and protagonist settings.

#### Scenario: Opening Setting
- **WHEN** Chapter 1 starts
- **THEN** Protagonist Chen Fan travels to a fantasy world
- **THEN** Discovers he has obtained a sign-in system
```

#### Manual Creation (Optional)

If not using an AI assistant, you can create manually:

```bash
mkdir -p novelspec/changes/add-chapter-1-10/specs/outline
touch novelspec/changes/add-chapter-1-10/proposal.md
touch novelspec/changes/add-chapter-1-10/tasks.md
touch novelspec/changes/add-chapter-1-10/specs/outline/spec.md
```

Then write content according to the format.

---

### Stage 2: Validate Proposal

**Goal**: Ensure proposal format is correct and specs are verifiable.

#### Run Validation

```bash
novelspec validate add-chapter-1-10
```

#### Validation Output (Passed)

```
Change: add-chapter-1-10
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Format Verification:
âœ“ proposal.md contains Why/What/Impact
âœ“ tasks.md uses task list format
âœ“ specs/outline/spec.md uses ADDED format
âœ“ specs/characters/protagonist/spec.md format is correct
âœ“ All Requirements have at least one Scenario
âœ“ All Scenarios use #### Scenario: format

Verification Result: Passed
```

#### Validation Output (Failed)

```
Change: add-chapter-1-10
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Format Verification:
âœ“ proposal.md contains Why/What/Impact
âœ“ tasks.md uses task list format
âœ— specs/outline/spec.md:15
    Scenario must use #### Scenario: format (4 hashes)
    â†’ Currently using ### Scenario: (3 hashes)

Verification Result: 1 error
Please fix errors and re-validate.
```

#### Strict Validation

```bash
novelspec validate add-chapter-1-10 --strict
```

Strict validation checks additionally:
- Each Requirement has at least one Scenario
- Scenario uses `#### Scenario:` format (4 hashes)
- Use SHALL/MUST/MAY keywords
- Scenario contains WHEN/THEN conditions

#### Fix Errors

Fix files based on validation output, then re-validate until passed.

---

### Stage 3: Execute Writing

**Goal**: Write chapter content according to proposal and task list.

#### Write using AI Assistant

Execute in Cursor/Claude/Windsurf:

```
/novelspec-apply
```

#### AI Execution Process

1. **Read Context** (by priority)

```
1. novelspec/project.md (Creative principles, style guide)
2. novelspec/specs/characters/ (Character specs)
3. novelspec/specs/worldbuilding/ (Worldview specs)
4. novelspec/specs/outline/ (Existing outline)
5. novelspec/changes/add-chapter-1-10/ (Current task)
```

2. **Execute in `tasks.md` order**

```
Task 1.1: Create protagonist spec
â†’ Generate novelspec/specs/characters/protagonist/spec.md

Task 2.1: Chapter 1 - Awakening
â†’ Generate chapters/volume-1/chapter-001.md
â†’ Content conforms to all specs
â†’ Automatically run novelspec validate
```

3. **Generate Chapter Content**

AI ensures:
- Adheres to `project.md` style guide (3000-4000 words, modern vernacular)
- Protagonist behavior conforms to `protagonist/spec.md`
- Magic usage conforms to `magic-system/spec.md`
- Plot conforms to Chapter 1 Requirement in `outline/spec.md`

4. **Mark Completed Tasks**

```markdown
## 2. Chapter Writing
- [x] 2.1 Chapter 1: Awakening  â† Marked as complete
- [ ] 2.2 Chapter 2: Exploring the System
```

#### Manual Writing (Optional)

If not using an AI assistant, manual writing:

1. Read `proposal.md`, `design.md`, `tasks.md`
2. Read all relevant `specs/`
3. Write according to `tasks.md` order
4. Validate once after completing each chapter
5. Manually mark completed tasks

---

### Stage 4: Continuous Verification

**Goal**: Ensure written content conforms to specs, discover errors in time.

#### Validate After Each Chapter

```bash
novelspec validate add-chapter-1-10
```

#### Validation Dimensions

1. **Format Validation**
   - proposal.md, tasks.md, spec.md format correctness

2. **Semantic Validation** (Not supported in MVP, implemented in Phase 2)
   - Protagonist behavior conforms to `specs/characters/protagonist/spec.md`
   - Magic usage conforms to `specs/worldbuilding/magic-system/spec.md`
   - Plot conforms to `specs/outline/spec.md`

3. **Cross-Chapter Validation** (Not supported in MVP, implemented in Phase 3)
   - Timeline consistency
   - Character status consistency
   - Foreshadowing management

#### Fix Errors Immediately

If validation fails:

1. View error details
2. Fix files
3. Re-validate
4. Ensure passed before continuing

---

### Stage 5: Archive Change

**Goal**: Merge spec deltas to `specs/`, move change to `archive/`.

âš ï¸ **Note**: `archive` command is not supported in MVP, will be implemented in Phase 2.

#### Archive Process (Phase 2)

```bash
novelspec archive add-chapter-1-10
```

System automatically:

1. **Merge delta to specs/**

```
Merge changes/add-chapter-1-10/specs/outline/spec.md
  â†’ specs/outline/spec.md

Operations:
- ADDED Requirements appended to specs/outline/spec.md
- MODIFIED Requirements replace corresponding content
- REMOVED Requirements delete corresponding content
```

2. **Move to archive/**

```
Move changes/add-chapter-1-10/
  â†’ changes/archive/2025-01-22-add-chapter-1-10/
```

3. **Result**

```
âœ“ specs/ becomes the new Single Source of Truth, containing full outline for chapters 1-10
âœ“ archive/ retains full change history and intent
âœ“ AI reads latest specs/ as context when writing Chapter 11 next time
```

---

## Practical Example

### Complete Creation Process: Chapters 1-10

#### 1. Create Proposal

```
/novelspec-proposal
```

Answer:
```
Write chapters 1-10, protagonist travels to a fantasy world, obtains a sign-in system, completes introductory cultivation
```

#### 2. Validate Proposal

```bash
novelspec validate add-chapter-1-10 --strict
```

#### 3. Execute Writing

```
/novelspec-apply
```

AI automatically writes 10 chapters, generating:

```
chapters/volume-1/
â”œâ”€â”€ chapter-001.md (3,200 words)
â”œâ”€â”€ chapter-002.md (3,500 words)
â”œâ”€â”€ chapter-003.md (3,300 words)
...
â””â”€â”€ chapter-010.md (3,400 words)
```

#### 4. Continuous Verification

Automatically validate after each chapter, ensuring conformity to specs.

#### 5. Archive Change (Phase 2)

```bash
novelspec archive add-chapter-1-10
```

#### 6. Create Next Batch of Chapters

```
/novelspec-proposal
```

Answer:
```
Write chapters 11-20, Sect Competition, protagonist demonstrates strength
```

Repeat steps 1-5.

---

## FAQ

### Q1: How to modify existing specs?

Use MODIFIED operation:

```markdown
# novelspec/changes/update-protagonist/specs/characters/protagonist/spec.md

## MODIFIED Requirements

### Requirement: Capability Growth
[Copy original Requirement completely and modify]
```

### Q2: How to add new characters?

Use ADDED operation:

```markdown
# novelspec/changes/add-supporting-chars/specs/characters/li-jian/spec.md

## ADDED Requirements

### Requirement: Basic Setting
Li Jian SHALL be the recognized genius of the outer sect.

#### Scenario: Identity Information
- **WHEN** Li Jian appears or is mentioned
- **THEN** Name: Li Jian
- **THEN** Age: 22 years old
```

### Q3: How to delete specs?

Use REMOVED operation:

```markdown
## REMOVED Requirements

### Requirement: Old Setting
**Reason**: Conflicts with subsequent plot
**Migration**: Use new XXX setting instead
```

### Q4: What if Scenario format is incorrect?

**Error**:
```markdown
### Scenario: Identity Information  âŒ (3 hashes, should be 4)
```

**Correct**:
```markdown
#### Scenario: Identity Information  âœ“ (4 hashes)
```

### Q5: How to view change details?

```bash
novelspec show add-chapter-1-10
```

---

## Best Practices

### 1. Specs First

Define specs first, then create content:

âœ… **Good Practice**:
```
1. Create proposal (define outline for chapters 1-10)
2. Validate proposal
3. Write chapters
```

âŒ **Bad Practice**:
```
1. Write chapters directly
2. Add specs afterwards
```

### 2. Incremental Evolution

Focus on 10-20 chapters per change, avoid overly large scope:

âœ… **Good Practice**:
```
add-chapter-1-10   (10 chapters)
add-chapter-11-20  (10 chapters)
add-chapter-21-30  (10 chapters)
```

âŒ **Bad Practice**:
```
add-chapter-1-100  (100 chapters, scope too large)
```

### 3. Continuous Verification

Validate once after completing each chapter:

âœ… **Good Practice**:
```
Write Chapter 1 â†’ Validate â†’ Write Chapter 2 â†’ Validate â†’ ...
```

âŒ **Bad Practice**:
```
Write 10 chapters â†’ Validate all at once (errors accumulate)
```

### 4. Foreshadowing Records

Record foreshadowing and resolution plans in `design.md`:

```markdown
## Foreshadowing Arrangement
- Chapter 13: Plant foreshadowing for Elder Yun's true identity (Revealed in Volume 2)
- Chapter 17: Hint at internal sect conflicts (Main plot of Volume 2)
```

### 5. Character Consistency

Strictly adhere to `characters/` specs, avoid OOC:

âœ… **Good Practice**:
```
Refer to specs/characters/protagonist/spec.md
- When facing danger: Remain calm, analyze rationally
- When facing temptation: Analyze risks and costs first
```

âŒ **Bad Practice**:
```
Ignore specs, let rational character suddenly act impulsively (OOC)
```

### 6. Regular Archiving

Archive promptly after completing a batch of chapters:

âœ… **Good Practice**:
```
Chapters 1-10 complete â†’ Archive â†’ Chapters 11-20
```

âŒ **Bad Practice**:
```
Archive only after completing chapters 1-100
```

---

## Appendix

### Command Cheat Sheet

```bash
# Initialize project
novelspec init <project-name>

# Validate change
novelspec validate [change-id]
novelspec validate --strict
novelspec validate --json

# Archive change (Phase 2)
novelspec archive <change-id>

# Help
novelspec --help
```

### AI Assistant Command Cheat Sheet

```
/novelspec-proposal   # Create change proposal
/novelspec-apply      # Execute writing
/novelspec-archive    # Archive change (Phase 2)
```

### Spec Format Cheat Sheet

```markdown
### Requirement: [Requirement Name]
[Description, use SHALL/MUST/MAY]

#### Scenario: [Scenario Name]
- **WHEN** [Condition]
- **THEN** [Result]
```

### Delta Operation Cheat Sheet

```markdown
## ADDED Requirements      # New
## MODIFIED Requirements   # Modify (Copy completely)
## REMOVED Requirements    # Delete (Mark reason)
## RENAMED Requirements    # Rename (Mark FROM/TO)
```

---

**Happy Writing! ğŸ“âœ¨**
